{
  "automatic_https": {
    "disable": true
  },
  "listen": [":80"],
  "routes": [
    {
      "@id": "admin-health",
      "handle": [
        {
          "body": "{\"service\":\"admin\",\"status\":\"healthy\"}",
          "handler": "static_response",
          "headers": {
            "Content-Type": ["application/json"]
          },
          "status_code": 200
        }
      ],
      "match": [
        {
          "host": ["admin.localhost"],
          "path": ["/health"]
        }
      ],
      "terminal": true
    },
    {
      "@id": "admin-service",
      "handle": [
        {
          "handler": "authentication",
          "providers": {
            "http_basic": {
              "accounts": [
                {
                  "password": "$2a$14$lVk5aohGe.EmndSm6H1uJeOI/lOcaTHoJYSk/8dn1DDsW5NbNqVLW",
                  "username": "admin"
                },
                {
                  "password": "$2a$14$lVk5aohGe.EmndSm6H1uJeOI/lOcaTHoJYSk/8dn1DDsW5NbNqVLW",
                  "username": "superadmin"
                }
              ],
              "realm": "Admin Dashboard"
            }
          }
        },
        {
          "handler": "reverse_proxy",
          "upstreams": [
            {
              "dial": "echo-test:5678"
            }
          ]
        }
      ],
      "match": [
        {
          "host": ["admin.localhost"],
          "path": ["/*"]
        }
      ],
      "terminal": true
    },
    {
      "@id": "api-health",
      "handle": [
        {
          "body": "{\"service\":\"api\",\"status\":\"healthy\"}",
          "handler": "static_response",
          "headers": {
            "Content-Type": ["application/json"]
          },
          "status_code": 200
        }
      ],
      "match": [
        {
          "host": ["api.localhost"],
          "path": ["/health"]
        }
      ],
      "terminal": true
    },
    {
      "@id": "api-admin-path",
      "handle": [
        {
          "handler": "authentication",
          "providers": {
            "http_basic": {
              "accounts": [
                {
                  "password": "$2a$14$6bYQvFSJUbyRLQ3vjnjBWu1ea6Sj3GiJAcp4vaVXF0NtuNhhs7.x.",
                  "username": "apiuser"
                }
              ],
              "realm": "API Admin"
            }
          }
        },
        {
          "handler": "reverse_proxy",
          "upstreams": [
            {
              "dial": "echo-test-2:5679"
            }
          ]
        }
      ],
      "match": [
        {
          "host": ["api.localhost"],
          "path": ["/admin/*"]
        }
      ],
      "terminal": true
    },
    {
      "@id": "api-public",
      "handle": [
        {
          "handler": "reverse_proxy",
          "upstreams": [
            {
              "dial": "echo-test-2:5679"
            }
          ]
        }
      ],
      "match": [
        {
          "host": ["api.localhost"],
          "path": ["/*"]
        }
      ],
      "terminal": true
    },
    {
      "@id": "public-health",
      "handle": [
        {
          "body": "{\"service\":\"public\",\"status\":\"healthy\"}",
          "handler": "static_response",
          "headers": {
            "Content-Type": ["application/json"]
          },
          "status_code": 200
        }
      ],
      "match": [
        {
          "host": ["public.localhost"],
          "path": ["/health"]
        }
      ],
      "terminal": true
    },
    {
      "@id": "public-service",
      "handle": [
        {
          "handler": "reverse_proxy",
          "upstreams": [
            {
              "dial": "echo-test-3:5680"
            }
          ]
        }
      ],
      "match": [
        {
          "host": ["public.localhost"],
          "path": ["/*"]
        }
      ],
      "terminal": true
    }
  ]
}
